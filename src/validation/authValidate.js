import { check } from "express-validator";
import { transValidate } from "./../../lang/vi";

let register = [
  check("username", transValidate.username_incorrect)
    .trim()
    .isLength({min: 3, max: 17})
    .matches(/^[\s0-9a-zA-Z_ÀÁÂÃÈÉÊÌÍÒÓÔÕÙÚĂĐĨŨƠàáâãèéêìíòóôõùúăđĩũơƯĂẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼỀỀỂưăạảấầẩẫậắằẳẵặẹẻẽềềểỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪễệỉịọỏốồổỗộớờởỡợụủứừỬỮỰỲỴÝỶỸửữựỳỵỷỹ ]+$/),
  check("email", transValidate.email_incorrect)
    .isEmail()
    .trim(),
  check("password", transValidate.password_incorrect)
    .isLength({min: 8})
    .matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[$@$!%*?&])[A-Za-z\d$@$!%*?&]{8,}$/),
  check("repeat_password", transValidate.password_confirmation_incorrect)
    .custom(( val, {req}) => {
      return val === req.body.password
    })
]

module.exports = {
  register
};





